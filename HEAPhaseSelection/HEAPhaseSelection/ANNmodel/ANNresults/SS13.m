function [Y,Xf,Af] = SS13(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 20-Feb-2019 21:10:15.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx13 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx1 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.867076923076923;0.00279595827039172;437.535;5.12923152138799;-76.44;0;0.198515243345873;1.1657;0;1.61538461538462;0;25765000000;0.484122918275927];
x1_step1.gain = [2.08211997670356;6.05469648797198;0.000699024104098669;0.0016871699604234;0.0231642344220524;0.0588456417471217;1.00064574972844;1.51941046873813;4.00249121426347;0.196969696969696;0.369863360727655;7.26043023634097e-12;0.0144813358040795];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.4679321402781648764;1.8747870932101915464;1.3111161496740237897;-1.5181935445448537791;-1.5279116321323151784;2.3308823495034087792;1.0008315423413480794;0.75188997731850237827;-2.664408897214185945;-0.91683803829876664437;1.3335361440933843902;-0.023560484910879468667;0.46905384397581972866;1.6874028654579842357;-1.5121897128641255126;-0.92589208872408790274;-1.1280219248150853417;1.8865891267554686372;-1.4377627829225101408;-1.2404258686617914975];
IW1_1 = [-1.5648220203459122235 1.0311984755618528453 0.76099402386565273559 -0.97427193031979908433 -0.75888219280102742204 2.3215159752401137716 1.9644072612206899819 -2.0338685407312016018 -1.5145628351786677435 -0.64616089061201464894 -0.39442318705685186497 1.1423804993204587088 0.34541261099713865823;-0.33540402769522276172 -0.14159298648033707968 -0.11189169512906819992 -0.43710293253676990588 0.13213445036776749753 -1.0500762697885772656 0.68585019384308443247 -0.17428314090935950742 -0.083437962426407136229 -0.52085206015195573137 0.34692992134490258094 -0.57164634054164753518 -0.30314815675158096608;-0.55237084488975252139 0.33593346119769995628 0.57349576562731297003 -0.48826363681508111458 0.41078295461887992523 0.064854510046565880255 0.77587803103728114618 -0.73565746878159010702 0.11746320205553135996 -1.2416522794841513555 -0.044388481394752182796 0.99370796891385793081 -0.68729113552623277705;0.27441925848087145301 0.05937046884450325468 -0.62937774257601619698 0.02488007887502794932 0.38359998730184619031 0.99893369489561345542 -0.58865912973207423775 -0.42377378050278652344 0.24525908758470826854 -0.50862768563491522755 -0.024300158135471035953 0.71066454319493288505 -0.34594613478748281743;0.48923210723100291064 -0.43077139897933514057 0.47280178631954056234 0.26983646873166666769 -0.57620781856244640551 0.62837389806082211141 -0.38897424631047100574 -0.14323263746575590205 0.082196503676144089257 0.21958628173861829969 0.29593032994609880237 0.79007327764433088468 -0.41799590582592394128;-0.49353153182179304581 1.8559021445371159942 -0.2080201986992838703 0.23266804815456482158 -4.8161255871536718942 -0.15779372088297938248 3.1498069484356050474 0.86696622510994425514 -0.43478932942043635457 0.68678852211231433689 1.5629092648544031796 -1.7725666544883478259 -1.19681496129409215;-0.27729038067858946537 -0.43115822496660705099 -0.16986413715886838904 -0.55300787331680467673 0.70988626247355246512 -0.67526845895958487187 0.75255911385688434301 0.71829030301438490103 0.21842612564598387626 -0.58710341147804823159 0.22611079810116752054 -0.14631603314208360689 -0.28721340870820660784;0.017551763446564130899 -0.75531738659845559791 -0.40523155312618364121 -0.66609391942137852194 0.51029155611571053175 -0.96445569170114853197 -0.15643552041676039854 -0.037807450457596029902 -0.38776939682753330807 -0.42102906854263311143 0.61419974022259071766 0.26517295599681117713 -0.07257348682334066603;-0.74945163284564297879 -2.53110952182716753 0.062014557355410754313 1.3080091447356620993 1.815009582100826746 0.40885678024456556523 6.1448660135341572897 -0.014114051560660405976 -2.6771964105852990023 -0.46485728405818022013 -0.64210365790605494762 0.65589602793075429954 0.49756708261911158919;-0.49520712263874899772 -0.67332703680298855442 0.30360312324293725617 -0.86542570002197960477 2.494504022232839624 0.24633744398224646788 -0.55793938296549028255 0.20909712526812762601 1.339220369957030865 0.19782367283023696847 -0.3029755600915543523 0.38580535314388075818 0.070246152949604068194;-1.267918333096128114 1.9573149674562628775 0.76416125110434784951 1.5211283281710488158 -0.74606020185637755837 -0.33288696310823762126 -0.29965871036361901858 0.6495890279069010953 0.37787159858848018423 -0.87216234140567372446 0.057819119416114693466 1.2388575064946638626 1.833935684845662939;0.58553157825811774639 -0.88317956077548831484 0.017230450079420492338 -0.46743024484919870609 0.057429882555345694584 0.78948872971909966889 1.0203135079256711037 -0.68554226935480766514 0.25397827830935115756 -0.69496379820892240087 0.19635302340461333048 -0.92554081123704234901 -0.51883105686608832485;0.54777133807318767467 -3.3085094640458159176 0.024209519207616745501 -1.5066468399814743062 1.0256075765663783539 0.52983379181708634142 -0.34576192143144951485 0.065254716087175340666 2.6567983222096471785 2.5317932839076964235 0.77867852198561471333 0.36352730485868373078 -0.89037702953716790777;0.077483297297526246283 1.1582625226199845248 0.80969400457179763198 -1.3463584804639789905 -0.61098473486385185272 -0.18460017745461493321 -1.4227947254141630751 -0.026038127350545132305 0.31206735946814379012 -1.5677954279736998622 -2.1181892359800147396 -0.58164096677985099859 -0.094199828828678291992;-0.55728626517759238812 -0.89100626680217098752 -0.22782159806921958856 -0.43425427674576472237 0.82054955207826596464 0.42058299821555733544 0.13178250119871370849 -0.65892924426669940985 0.2929776131374742798 0.44046335756964616337 0.01348586556048690481 0.30088874765155404489 -0.13391540270148810654;-1.0160172033886838427 1.1263575415612041564 0.12885621944422970264 0.62416260607435924967 0.089809567278768584475 -0.5131226210096405671 -0.16455575143167511243 -0.31253755455595716439 -0.72855698460440820874 -0.4242846540494407126 0.64767749911030281229 0.47253764731547009958 1.1823582194426971448;-0.51592828794325185093 -0.040341104669351118828 0.38119234412522651212 0.34901169116662539293 -0.59115946473546421291 -0.15035207721423538008 -0.6788381559042716562 -0.48709146680384990402 0.63060197354684788262 -0.73368886224564711096 -0.79191489578921114845 0.044137728339222616347 0.092840138769558253062;0.92330242364978509784 0.10733015219148495101 -0.63301101512155388829 1.1273420056758907126 0.97944508762574156169 -0.58097569702676166159 1.8349232127783314805 0.59962614724877294492 0.41787955701743073611 -0.96169569669055710026 0.50684227309777307724 -1.0445766769640165705 -0.71779185979448179022;-0.16193336519698844911 0.2413965243716962028 0.26631805997185431512 -0.24601815241089511344 -0.96132988973502020436 -0.025028502584056398078 -0.45727684559966857991 0.77123318978711097316 0.67414530072779987879 0.0614150027215498856 0.28623123366285191382 0.1700333704620009545 -0.81441055341977919291;-0.70764311700979176667 -0.187852898044362282 -0.3794197716931055897 -0.53346312117738536873 0.80672775575698063566 -0.28956727091862377588 -0.7085609033004589552 0.38980331574223875402 -0.98146896107076098126 0.37795192625749635118 0.56503835500258225988 0.48537016355974926807 0.38954441798133659924];

% Layer 2
b2 = -0.90508076734610465319;
LW2_1 = [4.0281755822441587256 -0.9305446435894929591 0.67781681225220524745 1.7394187934264859763 1.3609002862994958871 -4.2663846245164478432 -0.38052424080001795437 0.26633714313773987348 4.9046104148985198989 -0.42322294749816458115 -2.3465667183867551238 -1.7251163580043797907 2.8939384762122553063 -1.9534446245151979582 -0.54275815270284744063 -1.0559626653303051391 0.29844611307864477023 -2.7521283661162776468 0.28145556538898924837 0.57815031579125419903];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n,~)
a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
