function [Y,Xf,Af] = IM11(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 21-Feb-2019 20:52:27.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx11 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx1 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.867076923076923;437.535;5.12923152138799;0;0.198515243345873;1.1657;0;1.61538461538462;0;25765000000;0.484122918275927];
x1_step1.gain = [2.08211997670356;0.000699024104098669;0.0016871699604234;0.0588456417471217;1.00064574972844;1.51941046873813;4.00249121426347;0.196969696969696;0.369863360727655;7.26043023634097e-12;0.0144813358040795];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.2594199367907903397;-2.6442528759808432426;1.6350870716015706297;1.6813939050151491816;-1.9443683363145933818;-1.3443425794253300865;0.71302009883859185368;0.014563897014594290313;-0.74076754700892510908;2.0508152018017553608;-0.47268798715813370448;0.54137089288851103497;-0.18336626881569301206;1.4472374516917336784;-0.96332084826067065908;-0.99632514894406098982;-0.39697712934606493862;-0.05996581738365674985;-2.0156986480448200183;0.7016074860168863836];
IW1_1 = [0.14039192347281284623 -1.4542187767342087401 1.7870811995150925888 -1.2867328606160035598 -1.5297272181887302533 0.55720303281492400416 2.2117005292742462075 -0.33381443650641845489 -1.319170541386054607 0.56620390006968479568 0.18158787357885464164;0.67895912718203554892 -0.074282482191904031232 -0.31026751559831533545 0.44799121090624666186 -0.13104607184871686076 0.85913543365826694487 -0.60550834618500104511 0.099822391130589341324 -0.36467057284146908724 0.3189602049867283351 -0.13471340105828294442;-0.55170991374838995736 -0.66207268981795563967 1.3795966839490498845 0.59675484706606507501 0.019213743320502605499 0.34824839469371504652 1.0406537154980972648 -0.61117741931931313104 -0.47170911954518662812 -0.43032539183696394414 0.89480091058274147109;-0.08357229884450566304 -1.9996624778840272896 0.64965398740721047588 0.6619974976651895604 0.85562672341712686652 -0.83768228036992298247 -0.7938923200736629493 -1.6872353812654190541 1.6879946471972990807 -1.1564289597901891149 0.65654392698495267489;1.66413652446338034 -0.64488053213141049991 -1.1850565951194043102 1.4039026401277663325 0.1863795017017884359 -0.062887128733065802977 0.71784666925800044712 0.93969711621647644684 -0.13461664855535385166 -0.83082064656171461525 -2.1573915642088130618;1.022046427936685431 -0.12153919172363576717 0.56770934617245860654 0.53980414789974306977 1.3670281806670738778 -0.71707513409528989001 -0.47092103277089736313 -0.41418019827407370759 -0.64573841210820726033 0.34762493542210565201 -1.9801049888529311804;-0.13138069485645278989 0.43315673702927126598 -0.4540007330401689134 0.97991535229681447916 0.51683317260189365339 -0.24167773205929707347 -0.018277712760888457921 -0.94649071510110960315 -0.63219868082668051468 0.77815345515807166077 -0.88450395187627006699;-1.7781221711483377046 -1.8237316704648296461 -1.3117647095806508339 0.20205704997325149574 1.9169149794500537354 2.1049721221378345781 -0.59516244347944891047 1.1777194179222010284 -1.0151861204234111646 -0.20954797205732839105 -0.33133218954512044796;0.98348385742974420154 -3.0088944456662995997 -1.032189858741810351 -1.3370228491616626965 -2.6485561251135716354 -0.57056212469692890732 -0.45598549953984091054 1.9764406664892841814 0.88265839895403819249 -1.4750799547971322756 0.12919980633367383893;0.96875029594039707703 3.4422766745345061423 -1.1309806868553984316 3.2444233713148293852 3.0827458697466778581 -0.55312948414334861535 -1.2851558828927753808 3.2612852747760925354 -0.32031022918666191002 -0.4475073735255853391 -0.97317122722762672282;-0.27532758745649321686 -1.2467617326350608487 1.3998324729839093372 -1.8358720778399095774 -1.7259539038321483062 1.4859543094356957305 1.3360472021418665634 0.0078592487658411501472 2.6766056347256483861 1.7534758334712026162 -0.20363793035147914612;-0.54810855377339806616 -0.76004796040863109585 -0.046722631708983733412 -0.80405335734779870283 0.2929088264280955145 0.60033281588427545028 0.84115667163706353548 0.29139570837110662094 0.37772475739357214142 -0.79534365695711373156 -0.37206313785844741249;-0.90860224794067279142 -0.65213743473260088468 -0.69719704379658942184 -1.0037335431786764683 -0.40566869002438554759 -0.21136660570381057833 -0.96859487659678322746 -0.54456101465826767249 -0.3575040066518230808 -0.37135135470300206784 -0.41978895663928011972;0.67727322240173382095 1.9476150649782892899 -0.53340644864956843207 -0.13411855783807849485 1.4213908745120475974 -0.99369473485942916291 -0.023287711913493793631 1.4743776209408809841 0.48065301231146473349 0.92990014805266563158 0.3677404027343580406;-2.3848304757611726856 -1.6073335571364075758 -0.19790371666469752654 0.49581561018971481714 2.5238910613659317761 2.0091917404192924934 -0.28522942625810615569 0.53440084590378134077 -0.82835289953579749334 -0.056342486164283694938 2.1751501287508543392;-1.324772053725373322 0.072061547722902768998 0.09502006434748482 -2.7973242058656424547 2.431890875305524613 -1.2183569191009790966 -1.7987075077506267107 0.64584491782752595501 -1.5897002128461941162 1.6061571326359969092 0.19021131893566037285;-0.063946873789282515643 0.23397915475807243291 -0.31756345961121729138 0.89346462591302833189 1.6290218267257234874 0.16847428124900859503 0.078177965268358101669 0.39494368042574712341 -0.21346166619193240876 -1.1413451398100999956 -1.5590667301343925644;0.43115763542138008102 -0.47370191000261835379 0.10743893849717868483 1.5283763814258422009 -0.58605389701951593473 -0.34699559211177999352 -0.022365750203932745904 1.404213819477765357 1.6351278754547735605 0.5791351502201814716 0.73467488632680477689;1.3473761554581416 0.32579157982788897741 -0.062996750155868835863 -0.7072846584096503797 -1.879535079340890702 -2.5447784097409757997 2.6186463196752893801 -1.3060067345673231909 1.0538673545328058889 -1.7568373845412097456 -0.12473798245018587194;0.66784029872750094725 -0.64236237517202932068 0.33045309405714917705 -0.31962214206531175398 -1.6369551076959618641 -0.31834032396622996552 -2.652772934945173855 1.3192878181887801592 1.5515126916638439791 -1.5749429204183755804 1.4162733855247744419];

% Layer 2
b2 = 1.1205602566789720775;
LW2_1 = [3.2210527264693231686 -1.0770492958821162865 -1.343178108488398026 2.5990267267000106699 3.0294536848406070639 1.2857154089080666814 -0.82912226334367267189 2.9929950880582909534 -2.5961684313824098247 -5.6510396134043370253 3.2188857822634635575 0.75436438106931857916 0.55745160833059104188 -1.3999302661240073942 -4.0897419174444200607 2.8884814373691800604 0.94063420667327479752 0.9080408116015541431 -3.4653823517793291842 -1.4223458298680080603];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n,~)
a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
